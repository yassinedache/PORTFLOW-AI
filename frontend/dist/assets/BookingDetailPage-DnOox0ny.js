const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-qr-B_hbMkRx.js","assets/vendor-query-CF9v-Zna.js"])))=>i.map(i=>d[i]);
import{c as k,S as H,m as i,h as E,B as T,j as l,Q as q,n as K,b as u,q as c,P as z,_ as V}from"./index-CEOHBZb-.js";import{j as e,f as Y,u as g,h as I,a as Q}from"./vendor-query-CF9v-Zna.js";import{B as b,k as U,l as M,R as _,P as $,m as W,C as d,c as x,a as h,b as j,S as Z}from"./card-BhKIbSNR.js";import{P as J}from"./Skeletons-CfQltb1a.js";import{c as m}from"./carrier-DbPZWpzb.js";import{f as X}from"./vendor-react-lqZWVjLj.js";import{Z as ee}from"./zap-6YYQRR_u.js";import{m as O}from"./vendor-motion-BvnwsIwX.js";import"./vendor-charts-sdUO6Spa.js";import"./vendor-radix-D-AkJh5d.js";import"./vendor-http-BN7VjlME.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=k("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=k("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=k("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);function te({riskLevel:a,probability:r,className:s}){const o={LOW:{variant:"success",icon:e.jsx(H,{className:"h-3 w-3"}),label:"Low Risk"},MEDIUM:{variant:"warning",icon:e.jsx(v,{className:"h-3 w-3"}),label:"Medium Risk"},HIGH:{variant:"destructive",icon:e.jsx(ae,{className:"h-3 w-3"}),label:"High Risk"}}[a.toUpperCase()]||{variant:"secondary",icon:e.jsx(v,{className:"h-3 w-3"}),label:a};return e.jsxs(b,{variant:o.variant,className:s,children:[o.icon,e.jsx("span",{className:"ml-1",children:o.label}),r!==void 0&&e.jsxs("span",{className:"ml-1 opacity-75",children:["(",r,"%)"]})]})}const ne=Q.lazy(()=>V(()=>import("./vendor-qr-B_hbMkRx.js").then(a=>a.i),__vite__mapDeps([0,1])).then(a=>({default:a.QRCodeSVG}))),N=[{key:i.PENDING,label:"Pending",icon:U},{key:i.CONFIRMED,label:"Confirmed",icon:M},{key:i.READY_TO_GO,label:"Ready to Go",icon:_},{key:i.CONSUMED,label:"Consumed",icon:M}];function pe(){var C,S,R,P;const{id:a}=X(),r=Y(),{data:s,isLoading:o}=g({queryKey:c.booking(a),queryFn:()=>m.getBooking(a),enabled:!!a}),{data:n}=g({queryKey:c.bookingCharges(a),queryFn:()=>m.getBookingCharges(a),enabled:!!a}),{data:p}=g({queryKey:c.proofs(a),queryFn:()=>m.getProofs(a),enabled:!!a}),F=I({mutationFn:()=>m.cancelBooking(a),onSuccess:()=>{r.invalidateQueries({queryKey:c.booking(a)}),r.invalidateQueries({queryKey:c.myBookings}),u.success("Booking cancelled")},onError:()=>u.error("Failed to cancel booking")}),A=I({mutationFn:()=>m.purchasePriority(a,{level:z.PRIORITY}),onSuccess:()=>{r.invalidateQueries({queryKey:c.booking(a)}),r.invalidateQueries({queryKey:c.bookingCharges(a)}),u.success("Priority purchased!")},onError:()=>u.error("Failed to purchase priority")});if(o||!s)return e.jsx(J,{});const w=N.findIndex(t=>t.key===s.status),G=s.qrToken&&[i.CONFIRMED,i.READY_TO_GO].includes(s.status),f=s.status===i.READY_TO_GO;return e.jsx($,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Booking Details"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[((C=s.terminal)==null?void 0:C.name)||"Terminal"," —"," ",E(s.createdAt)]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status===i.PENDING&&e.jsxs(T,{variant:"destructive",size:"sm",onClick:()=>F.mutate(),children:[e.jsx(W,{className:"mr-1 h-3 w-3"}),"Cancel"]}),s.status===i.CONFIRMED&&e.jsxs(T,{variant:"glow",size:"sm",onClick:()=>A.mutate(),children:[e.jsx(ee,{className:"mr-1 h-3 w-3"}),"Priority Access"]})]})]}),e.jsx(d,{children:e.jsx(x,{className:"py-6",children:e.jsx("div",{className:"flex items-center justify-between",children:N.map((t,y)=>{const B=y<=w,L=t.icon,D=t.key===s.status;return e.jsxs("div",{className:"flex flex-1 items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(O.div,{initial:{scale:.8},animate:{scale:D?1.1:1},className:`flex h-10 w-10 items-center justify-center rounded-full transition-all ${B?D&&f?"bg-accent/20 text-accent animate-pulse-glow":"bg-primary/20 text-primary":"bg-secondary text-muted-foreground"}`,children:e.jsx(L,{className:"h-5 w-5"})}),e.jsx("span",{className:`mt-2 text-xs ${B?"font-medium text-foreground":"text-muted-foreground"}`,children:t.label})]}),y<N.length-1&&e.jsx("div",{className:`mx-2 h-0.5 flex-1 rounded-full ${y<w?"bg-primary":"bg-secondary"}`})]},t.key)})})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs(d,{children:[e.jsx(h,{children:e.jsx(j,{children:"Booking Info"})}),e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsx(Z,{status:s.status})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Terminal"}),e.jsx("span",{children:((S=s.terminal)==null?void 0:S.name)||"—"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Time Slot"}),e.jsx("span",{children:s.timeSlot?E(s.timeSlot.startTime):"—"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Container"}),e.jsx("span",{className:"font-mono",children:((R=s.container)==null?void 0:R.containerNumber)||"—"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Truck"}),e.jsx("span",{className:"font-mono",children:((P=s.truck)==null?void 0:P.plate)||"—"})]}),s.readinessScore!=null&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Readiness Score"}),e.jsx(te,{riskLevel:s.readinessScore>70?"LOW":s.readinessScore>40?"MEDIUM":"HIGH",probability:s.readinessScore})]}),s.price!=null&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Price"}),e.jsx("span",{className:"font-semibold",children:l(s.price)})]})]})]}),e.jsxs(d,{children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4 text-primary"}),"QR Code"]})}),e.jsx(x,{children:G?e.jsxs(O.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:200},className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:`rounded-2xl bg-white p-4 ${f?"animate-pulse-glow":""}`,children:e.jsx(Q.Suspense,{fallback:e.jsx("div",{className:"h-[180px] w-[180px] animate-shimmer rounded"}),children:e.jsx(ne,{value:s.qrToken,size:180,level:"H"})})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Show this QR code at the gate"}),f&&e.jsxs(b,{variant:"accent",className:"animate-pulse",children:[e.jsx(_,{className:"mr-1 h-3 w-3"}),"READY TO GO"]})]}):e.jsxs("div",{className:"flex flex-col items-center py-8 text-sm text-muted-foreground",children:[e.jsx(q,{className:"mb-2 h-12 w-12 opacity-20"}),e.jsx("p",{children:"QR code will appear once booking is confirmed"})]})})]})]}),n&&e.jsxs(d,{children:[e.jsx(h,{children:e.jsx(j,{children:"Charges Breakdown"})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-2 rounded-lg bg-secondary/30 p-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Slot Cost"}),e.jsx("span",{children:l(n.slotCost)})]}),n.ecoDiscount>0&&e.jsxs("div",{className:"flex justify-between text-sm text-success",children:[e.jsx("span",{children:"Eco Discount"}),e.jsxs("span",{children:["-",l(n.ecoDiscount)]})]}),n.priorityFee>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Priority Fee"}),e.jsx("span",{children:l(n.priorityFee)})]}),n.penalties>0&&e.jsxs("div",{className:"flex justify-between text-sm text-destructive",children:[e.jsx("span",{children:"Penalties"}),e.jsx("span",{children:l(n.penalties)})]}),e.jsx(K,{}),e.jsxs("div",{className:"flex justify-between text-sm font-bold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:l(n.total)})]})]})})]}),p&&p.length>0&&e.jsxs(d,{children:[e.jsx(h,{children:e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-primary"}),"Blockchain Proofs"]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-2",children:p.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-secondary/30 p-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium",children:t.entityType}),e.jsxs("p",{className:"font-mono text-xs text-muted-foreground",children:[t.hash.substring(0,24),"..."]})]}),e.jsxs(b,{variant:"success",children:[e.jsx(v,{className:"mr-1 h-3 w-3"}),"Verified"]})]},t.id))})})]})]})})}export{pe as default};
