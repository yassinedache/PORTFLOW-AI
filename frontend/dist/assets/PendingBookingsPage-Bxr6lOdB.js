import{f as R,a as N,u as B,h as C,j as e}from"./vendor-query-CF9v-Zna.js";import{m as q,P as E,h as b,B as o,b as l,q as k}from"./index-CEOHBZb-.js";import{P as D,C as A,c as L,B as Q,l as F,n as I}from"./card-BhKIbSNR.js";import{E as K}from"./EmptyState-CSoHTzce.js";import{T as M}from"./Skeletons-CfQltb1a.js";import{T as $,a as H,b as z,c as r,d as O,e as a}from"./table-BH3eB_Rj.js";import{D as G,a as X,b as Y,c as J}from"./dialog-BAM1R5W1.js";import{I as U}from"./input-DYGPj4ji.js";import{L as V}from"./label-BxPWq3jm.js";import{o as j}from"./operator-CmVVUFZE.js";import{m as W}from"./vendor-motion-BvnwsIwX.js";import{S as Z}from"./sparkles-COBm266N.js";import{L as P}from"./loader-circle-p231RGTX.js";import{b as _}from"./vendor-react-lqZWVjLj.js";import"./vendor-charts-sdUO6Spa.js";import"./vendor-radix-D-AkJh5d.js";import"./vendor-http-BN7VjlME.js";function ge(){const p=R(),S=_(),[c,t]=N.useState(null),[h,d]=N.useState(""),{data:m,isLoading:T}=B({queryKey:k.operatorQueue(),queryFn:()=>j.getQueue()}),i=m==null?void 0:m.filter(s=>s.status===q.PENDING),x=C({mutationFn:j.approveBooking,onSuccess:()=>{l.success("Booking approved"),p.invalidateQueries({queryKey:["operator","queue"]})},onError:()=>l.error("Failed to approve")}),n=C({mutationFn:({id:s,reason:u})=>j.rejectBooking(s,u),onSuccess:()=>{l.success("Booking rejected"),t(null),d(""),p.invalidateQueries({queryKey:["operator","queue"]})},onError:()=>l.error("Failed to reject")});return e.jsx(D,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Pending Bookings"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Review and approve or reject booking requests"})]}),e.jsx(A,{children:e.jsx(L,{className:"p-0",children:T?e.jsx("div",{className:"p-6",children:e.jsx(M,{})}):i!=null&&i.length?e.jsxs($,{children:[e.jsx(H,{children:e.jsxs(z,{children:[e.jsx(r,{children:"Terminal"}),e.jsx(r,{children:"Time Slot"}),e.jsx(r,{children:"Container"}),e.jsx(r,{children:"Priority"}),e.jsx(r,{children:"Readiness"}),e.jsx(r,{children:"Submitted"}),e.jsx(r,{className:"text-right",children:"Actions"})]})}),e.jsx(O,{children:i.map((s,u)=>{var f,v,y;const g=((f=s.priorityAccess)==null?void 0:f.level)===E.PRIORITY;return e.jsxs(W.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:u*.03},className:`border-b border-border/50 cursor-pointer transition-colors hover:bg-foreground/5 ${g?"ring-1 ring-yellow-500/30 bg-yellow-500/5":""}`,onClick:()=>S(`/app/operator/bookings/${s.id}`),children:[e.jsx(a,{className:"font-medium",children:((v=s.terminal)==null?void 0:v.name)||"—"}),e.jsx(a,{className:"text-sm text-muted-foreground",children:s.timeSlot?`${b(s.timeSlot.startTime)}`:"—"}),e.jsx(a,{className:"font-mono text-xs",children:((y=s.container)==null?void 0:y.containerNumber)||"—"}),e.jsx(a,{children:g?e.jsxs(Q,{className:"bg-yellow-500/20 text-yellow-400 border-yellow-500/30",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),"Priority"]}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"Standard"})}),e.jsx(a,{children:s.readinessScore!=null?e.jsxs("span",{className:`text-sm font-semibold ${s.readinessScore>=.7?"text-emerald-400":s.readinessScore>=.4?"text-yellow-400":"text-red-400"}`,children:[Math.round(s.readinessScore*100),"%"]}):e.jsx("span",{className:"text-xs text-muted-foreground",children:"—"})}),e.jsx(a,{className:"text-sm text-muted-foreground",children:b(s.createdAt)}),e.jsx(a,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",onClick:w=>w.stopPropagation(),children:[e.jsxs(o,{size:"sm",variant:"success",disabled:x.isPending,onClick:()=>x.mutate(s.id),children:[x.isPending?e.jsx(P,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx(F,{className:"h-3.5 w-3.5 mr-1"}),"Approve"]}),e.jsxs(o,{size:"sm",variant:"destructive",disabled:n.isPending,onClick:()=>t(s),children:[e.jsx(I,{className:"h-3.5 w-3.5 mr-1"}),"Reject"]})]})})]},s.id)})})]}):e.jsx(K,{title:"No pending bookings",description:"All bookings have been reviewed"})})}),e.jsx(G,{open:!!c,onOpenChange:()=>{t(null),d("")},children:e.jsxs(X,{children:[e.jsx(Y,{children:e.jsx(J,{children:"Reject Booking"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(V,{children:"Reason (optional)"}),e.jsx(U,{value:h,onChange:s=>d(s.target.value),placeholder:"Enter rejection reason..."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(o,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),e.jsxs(o,{variant:"destructive",disabled:n.isPending,onClick:()=>c&&n.mutate({id:c.id,reason:h||void 0}),children:[n.isPending&&e.jsx(P,{className:"h-4 w-4 animate-spin mr-2"}),"Confirm Reject"]})]})]})]})})]})})}export{ge as default};
