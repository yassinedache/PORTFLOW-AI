import{f as R,u as T,h as u,j as e}from"./vendor-query-CF9v-Zna.js";import{c as M,B as n,m as y,h as x,T as A,i as K,n as k,j as Q,S as b,b as i,q as l}from"./index-CEOHBZb-.js";import{P as I,S as L,C,a as w,b as S,c as P,k as D,l as $,n as z}from"./card-BhKIbSNR.js";import{E as G}from"./EmptyState-CSoHTzce.js";import{P as H}from"./Skeletons-CfQltb1a.js";import{E as O}from"./ErrorAlert-DJ0FKV30.js";import{c as X}from"./carrier-DbPZWpzb.js";import{o as j}from"./operator-CmVVUFZE.js";import{M as J}from"./map-pin-Cst-MQK0.js";import{L as p}from"./loader-circle-p231RGTX.js";import{f as U,b as V}from"./vendor-react-lqZWVjLj.js";import"./vendor-charts-sdUO6Spa.js";import"./vendor-radix-D-AkJh5d.js";import"./vendor-motion-BvnwsIwX.js";import"./vendor-http-BN7VjlME.js";import"./circle-alert-CA5_1Jce.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=M("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function xe(){var f,N,v;const{id:a}=U(),o=V(),r=R(),{data:s,isLoading:q,isError:B,refetch:E}=T({queryKey:l.booking(a),queryFn:()=>X.getBooking(a),enabled:!!a}),c=u({mutationFn:j.approveBooking,onSuccess:()=>{i.success("Booking approved"),r.invalidateQueries({queryKey:["operator","queue"]}),r.invalidateQueries({queryKey:l.booking(a)})},onError:()=>i.error("Failed to approve")}),d=u({mutationFn:F=>j.rejectBooking(F),onSuccess:()=>{i.success("Booking rejected"),r.invalidateQueries({queryKey:["operator","queue"]}),r.invalidateQueries({queryKey:l.booking(a)})},onError:()=>i.error("Failed to reject")}),m=u({mutationFn:j.confirmReadiness,onSuccess:()=>{i.success("Readiness confirmed"),r.invalidateQueries({queryKey:["operator","queue"]}),r.invalidateQueries({queryKey:l.booking(a)})},onError:()=>i.error("Failed to confirm readiness")});if(q)return e.jsx(H,{});if(B)return e.jsx(O,{onRetry:E});if(!s)return e.jsx(G,{title:"Booking not found",description:"It may have been removed",children:e.jsx(n,{variant:"outline",onClick:()=>o(-1),children:"Go back"})});const h=s.status===y.PENDING,g=s.status===y.CONFIRMED;return e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>o(-1),children:e.jsx(W,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Booking Detail"}),e.jsxs("p",{className:"text-sm text-muted-foreground font-mono",children:[s.id.slice(0,8),"…"]})]}),e.jsx(L,{status:s.status})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(C,{className:"lg:col-span-2",children:[e.jsx(w,{children:e.jsx(S,{className:"text-base",children:"Booking Information"})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(t,{icon:e.jsx(J,{className:"h-4 w-4"}),label:"Terminal",value:((f=s.terminal)==null?void 0:f.name)||"—"}),e.jsx(t,{icon:e.jsx(D,{className:"h-4 w-4"}),label:"Time Slot",value:s.timeSlot?`${x(s.timeSlot.startTime)} – ${x(s.timeSlot.endTime)}`:"—"}),e.jsx(t,{icon:e.jsx(A,{className:"h-4 w-4"}),label:"Truck",value:((N=s.truck)==null?void 0:N.plate)||"Not assigned"}),e.jsx(t,{icon:e.jsx(K,{className:"h-4 w-4"}),label:"Container",value:((v=s.container)==null?void 0:v.containerNumber)||"Not assigned"})]}),e.jsx(k,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(t,{label:"Price",value:s.price!=null?Q(s.price):"—"}),e.jsx(t,{label:"Created",value:x(s.createdAt)})]}),s.readinessScore!=null&&e.jsxs(e.Fragment,{children:[e.jsx(k,{}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"h-5 w-5 text-cyan-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Readiness Score"}),e.jsxs("p",{className:`text-2xl font-bold ${s.readinessScore>=.7?"text-emerald-400":s.readinessScore>=.4?"text-yellow-400":"text-red-400"}`,children:[Math.round(s.readinessScore*100),"%"]})]})]})]})]})]}),e.jsxs(C,{children:[e.jsx(w,{children:e.jsx(S,{className:"text-base",children:"Actions"})}),e.jsxs(P,{className:"space-y-3",children:[h&&e.jsxs(e.Fragment,{children:[e.jsxs(n,{className:"w-full",variant:"success",disabled:c.isPending,onClick:()=>c.mutate(s.id),children:[c.isPending?e.jsx(p,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx($,{className:"h-4 w-4 mr-2"}),"Approve"]}),e.jsxs(n,{className:"w-full",variant:"destructive",disabled:d.isPending,onClick:()=>d.mutate(s.id),children:[d.isPending?e.jsx(p,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(z,{className:"h-4 w-4 mr-2"}),"Reject"]})]}),g&&e.jsxs(n,{className:"w-full",variant:"glow",disabled:m.isPending,onClick:()=>m.mutate(s.id),children:[m.isPending?e.jsx(p,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(b,{className:"h-4 w-4 mr-2"}),"Confirm Readiness"]}),!h&&!g&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No actions available for this status"})]})]})]})]})})}function t({icon:a,label:o,value:r}){return e.jsxs("div",{className:"flex items-start gap-2",children:[a&&e.jsx("span",{className:"text-muted-foreground mt-0.5",children:a}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:o}),e.jsx("p",{className:"text-sm font-medium",children:r})]})]})}export{xe as default};
